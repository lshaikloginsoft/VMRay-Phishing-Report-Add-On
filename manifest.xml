<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
           xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
           xsi:type="MailApp">

  <!-- BASIC INFO -->
  <Id>b6583289-59ae-4026-baa6-ba32dfc6300a</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>VMRay</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>

  <DisplayName DefaultValue="Report Phishing"/>
  <Description DefaultValue="Report suspicious emails to security."/>

  <IconUrl DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/security_icon_32x32.png"/>
  <HighResolutionIconUrl DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/security_icon_80x80.png"/>
  <SupportUrl DefaultValue="https://vmray.com/support"/>

  <!-- DOMAIN -->
  <AppDomains>
    <AppDomain>lshaikloginsoft.github.io</AppDomain>
  </AppDomains>

  <!-- HOST -->
  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <!-- REQUIREMENTS -->
  <Requirements>
    <Sets>
      <Set Name="Mailbox" MinVersion="1.8"/>
    </Sets>
  </Requirements>

  <!-- REQUIRED FORM SETTINGS FOR v1.1 -->
  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/commands.html"/>
        <RequestedHeight>250</RequestedHeight>
      </DesktopSettings>
    </Form>
  </FormSettings>

  <Permissions>ReadWriteMailbox</Permissions>

  <!-- REQUIRED RULE -->
  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
  </Rule>

  <!-- VERSION OVERRIDES -->
  <mailappor:VersionOverrides xsi:type="mailappor:VersionOverridesV1_0">
    <mailappor:Hosts>
      <mailappor:Host xsi:type="mailappor:MailHost">
        <mailappor:DesktopFormFactor>
          <mailappor:ExtensionPoint xsi:type="mailappor:MessageReadCommandSurface">
            <mailappor:OfficeTab id="TabDefault">
              <mailappor:Group id="ReportPhishingGroup">
                <mailappor:Label resid="Group.Label"/>
                <mailappor:Control xsi:type="mailappor:Button" id="ReportPhishingButton">
                  <mailappor:Label resid="Button.Label"/>
                  <mailappor:Supertip>
                    <mailappor:Title resid="Button.Label"/>
                    <mailappor:Description resid="Button.Tooltip"/>
                  </mailappor:Supertip>
                  <mailappor:Icon>
                    <bt:Image size="16" resid="Icon.16"/>
                    <bt:Image size="32" resid="Icon.32"/>
                    <bt:Image size="80" resid="Icon.80"/>
                  </mailappor:Icon>
                  <mailappor:Action xsi:type="mailappor:ExecuteFunction">
                    <mailappor:FunctionName>reportPhishing</mailappor:FunctionName>
                  </mailappor:Action>
                </mailappor:Control>
              </mailappor:Group>
            </mailappor:OfficeTab>
          </mailappor:ExtensionPoint>
        </mailappor:DesktopFormFactor>
      </mailappor:Host>
    </mailappor:Hosts>

    <mailappor:Resources>
      <bt:Images>
        <bt:Image id="Icon.16" DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/security_icon_16x16.png"/>
        <bt:Image id="Icon.32" DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/security_icon_32x32.png"/>
        <bt:Image id="Icon.80" DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/security_icon_80x80.png"/>
      </bt:Images>

      <bt:Urls>
        <bt:Url id="Commands.Url" DefaultValue="https://lshaikloginsoft.github.io/VMRay-Phishing-Report-Add-On/commands.html"/>
      </bt:Urls>

      <bt:ShortStrings>
        <bt:String id="Group.Label" DefaultValue="Security"/>
        <bt:String id="Button.Label" DefaultValue="Report Phishing"/>
      </bt:ShortStrings>

      <bt:LongStrings>
        <bt:String id="Button.Tooltip" DefaultValue="Report this email as phishing"/>
      </bt:LongStrings>
    </mailappor:Resources>
  </mailappor:VersionOverrides>

</OfficeApp>
